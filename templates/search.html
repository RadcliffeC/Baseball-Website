{% extends "base.html" %}

{% block title %}Search | Baseball{% endblock %}

{% block content %}

    <h1>Search info on teams</h1>


    <form method="post">
        <label for="team_name">Team Name:</label>
        <select id="team_name" name="team_name">
            {% for team in teams %}
                <option value="{{ team }}">{{ team }}</option>
            {% endfor %}
        </select><br><br>

        <label for="year">Year:</label>
        <select id="year" name="year">
            {% for year in years %}
                <option value="{{ year }}">{{ year }}</option>
            {% endfor %}
        </select><br><br>

        <button type="submit">Swing!</button>
    </form>


    {%  if team %}

    <h3>
    {{ team.team_name }}    {{ team.years }}    {{ team.wins }}  {{ team.losses }} {{ team.team_hr }}   {{ team.park }}     {{ team.attendance }}
    </h3>


    {% endif %}

    <script>
    document.getElementById('team_name').addEventListener('change', function(e) {
        const team = this.value;
        const year_select = document.getElementById('year');

        year_select.innerHTML = '' ;

        if (team){
            fetch(`get_years/${team}`)
            .then(res => res.json())
            .then(data => {
                data.forEach(year => {
                    const option = document.createElement('option');
                    option.text = year;
                    option.value = year;
                    year_select.appendChild(option);
                });
                year_select.disabled = false;
            });
        } else{
            year_select.disabled = true;
        }
    });

    </script>

{% endblock %}
